import streamlit as st
import pandas as pd
import pydeck as pdk
import plotly.express as px

# ========================
# í˜ì´ì§€ ì„¤ì •
# ========================
st.set_page_config(
    page_title="ë¬¼ëŸ¬ì„œëŠ” ë•…, ë‹¤ê°€ì˜¤ëŠ” ë°”ë‹¤", 
    page_icon="ğŸŒŠ",
    layout="wide"
)

# ========================
# ì œëª© ë° ì„œë¡ 
# ========================
st.title("ë¬¼ëŸ¬ì„œëŠ” ë•…, ë‹¤ê°€ì˜¤ëŠ” ë°”ë‹¤: í•´ìˆ˜ë©´ ìƒìŠ¹ì˜ ìœ„í—˜ê³¼ ìš°ë¦¬ë§Œì˜ ëŒ€ì²˜ë²•")
st.markdown("""
ì¸ë¥˜ì˜ ê¸°ìˆ ì´ ë°œì „í•¨ê³¼ ë™ì‹œì— ì„¸ìƒì€ í™©íí•´ì ¸ ê°€ê³  ìˆìŠµë‹ˆë‹¤.  
ê¸°ì˜¨ ìƒìŠ¹, ë¶ê·¹ê³¼ ë‚¨ê·¹ ë¹™í•˜ì˜ ë…¹ìŒ, í•´ìˆ˜ë©´ ìƒìŠ¹ ë“±ìœ¼ë¡œ ìš°ë¦¬ì˜ ì‚¶ì˜ í„°ì „ì´ ìœ„í˜‘ë°›ê³  ìˆìŠµë‹ˆë‹¤.  
ì´ ëŒ€ì‹œë³´ë“œëŠ” ì²­ì†Œë…„ë“¤ì—ê²Œ í•´ìˆ˜ë©´ ìƒìŠ¹ì˜ ìœ„í—˜ì„±ê³¼ ëŒ€ì²˜ë²•ì„ ì•Œë¦¬ê³ ì ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
""")

# ========================
# ë³¸ë¡  1: í•´ìˆ˜ë©´ ìƒìŠ¹ ì§€ë„
# ========================
st.header("2050ë…„ ì˜ˆìƒ í•´ìˆ˜ë©´ ìƒìŠ¹ ì§€ë„")

cities_data = pd.DataFrame({
    "ë„ì‹œ": ["ì¸ì²œ", "ê´‘ì£¼", "ì „ì£¼", "ë¶€ì‚°"],
    "ìœ„ë„": [37.456, 35.159, 35.821, 35.179],
    "ê²½ë„": [126.705, 126.851, 127.147, 129.075],
    "í•´ìˆ˜ë©´_ìœ„í—˜": [70, 50, 30, 60]
})

layer = pdk.Layer(
    "ScatterplotLayer",
    data=cities_data,
    get_position='[ê²½ë„, ìœ„ë„]',
    get_radius='í•´ìˆ˜ë©´_ìœ„í—˜*1000',
    get_fill_color='[0, 0, 255, 140]',
    pickable=True
)

view_state = pdk.ViewState(
    latitude=36,
    longitude=127,
    zoom=6,
    pitch=0
)

r = pdk.Deck(
    layers=[layer],
    initial_view_state=view_state,
    tooltip={"text": "{ë„ì‹œ}\nìœ„í—˜ ìˆ˜ì¹˜: {í•´ìˆ˜ë©´_ìœ„í—˜}"}
)

st.pydeck_chart(r)

# ========================
# ë³¸ë¡  2: ì„¤ë¬¸ ë°ì´í„° ì‹œê°í™”
# ========================
st.header("ì²­ì†Œë…„ í•´ìˆ˜ë©´ ì¸ì‹ ì„¤ë¬¸ ê²°ê³¼")

survey_data = pd.DataFrame({
    "ì¸ì‹ìˆ˜ì¤€": ["ë‚®ìŒ", "ë³´í†µ", "ë†’ìŒ"],
    "ì¸ì›ìˆ˜": [40, 30, 10]
})

fig = px.pie(
    survey_data,
    names="ì¸ì‹ìˆ˜ì¤€",
    values="ì¸ì›ìˆ˜",
    title="ì²­ì†Œë…„ ì¸ì‹ ìˆ˜ì¤€ ë¹„ìœ¨",
    hole=0.3
)
fig.update_traces(textposition='inside', textinfo='percent+label')
st.plotly_chart(fig, use_container_width=True)

# ========================
# ê²°ë¡  ë° ëŒ€ì²˜ ë°©ì•ˆ
# ========================
st.header("ëŒ€ì²˜ ë°©ì•ˆ")
st.markdown("""
**ì˜¨ì‹¤ê°€ìŠ¤ ê°ì¶•**  
- í™”ì„ ì—°ë£Œ ì‚¬ìš© ì¤„ì´ê¸°, íƒœì–‘ê´‘Â·í’ë ¥ ì‚¬ìš© í™•ëŒ€  
- ì—ë„ˆì§€ íš¨ìœ¨ ë†’ì€ ì œí’ˆ ì‚¬ìš©, ê±´ë¬¼ ë‹¨ì—´ ê°•í™”  

**í•´ì•ˆ ì§€ì—­ ì ì‘ ë° ë³´í˜¸**  
- ë°©íŒŒì œ, í•´ì•ˆ ë°©ì¡°ì œ ê±´ì„¤  
- ìì—° í•´ì•ˆì„  ë³µì› (ë§¹ê·¸ë¡œë¸Œ ìˆ², ê°¯ë²Œ ë“±)  
- ì—°ì•ˆ ê´€ë¦¬ ê³„íš ìˆ˜ë¦½ ë° ì•ˆì „í•œ ì´ì£¼ ê³„íš  

**ê°œì¸ ì‹¤ì²œ**  
- ì—ë„ˆì§€ ì ˆì•½, ìì› ì¬í™œìš©  
- í™˜ê²½ ë¬¸ì œ ê´€ì‹¬ê³¼ ì°¸ì—¬
""")
